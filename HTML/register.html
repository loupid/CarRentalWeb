<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Location de voitures</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../CSS/styles.css" type="text/css">
    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="../JS/Main.js"></script>
    <script src="../JS/Get/ListOfCars.js"></script>
    <script src="../JS/RenderingManager.js"></script>
</head>
<body>
<script>
    $(document).ready(() => {
        $('#btn_confirm_login').click(() => {
            let stringJson = "{";
            $('div#form :input').serializeArray().forEach((e) => {
                stringJson += '"' + e.name + '":"' + e.value + '",';
            });
            stringJson = stringJson.substring(0, stringJson.length - 1) + "}";
            let data = JSON.parse(stringJson)

            debugger;
            if (!data.showdata){
                data.showdata = 'off';
            }

            if (isValid(data)) {
                $.ajax('../Php/Register.php', {
                    type: 'post',
                    data: data,
                    success: (dataResult) => {
                        dataResult = JSON.parse(dataResult);
                        if (dataResult.statusCode === 200) {
                            window.location = 'login.html';
                            alert("Inscription réussi")
                        } else if (dataResult.statusCode === 201) {
                            alert("Erreur lors de l'enregistrement");
                        }
                    }
                });
            }else alert("Erreur dans l'entrer des données")
            }
        );
    });
</script>
<div class="register">
    <p class="login_title">Inscription</p>
    <div id="form" class="login_credentials">
        <div class="input_container_login">
            <i class="fas fa-font icon" style="color: black"></i>
            <input class="field" type="text" id="firstname" name="firstname"
                   placeholder="Prénom" required>
        </div>
        <div class="input_container_login">
            <i class="fas fa-bold icon" style="color: black"></i>
            <input class="field" type="text" id="lastname" name="lastname"
                   placeholder="Nom" required>
        </div>
        <div class="input_container_login">
            <i class="fas fa-user icon" style="color: black"></i>
            <input class="field" type="text" id="username" name="username"
                   placeholder="Nom d'utilisateur" required>
        </div>
        <div class="input_container_login">
            <i class="fas fa-at icon" style="color: black"></i>
            <input class="field" type="email" id="register_email" name="register_email"
                   placeholder="Email" required>
        </div>
        <div class="input_container_login">
            <i class="fas fa-phone-square-alt icon" style="color: black"></i>
            <input class="field" type="text" id="phonenumber" name="phonenumber"
                   placeholder="Numéro de téléphone" required>
        </div>
        <div class="input_container_login">
            <i class="fas fa-lock icon" style="color: black"></i>
            <input class="field" type="password" id="register_password" name="register_password"
                   placeholder="Mot de passe" required><br>
        </div>

        <div class="register_privacy">
            <div class="register_privacy_text">
                <i class="fas fa-user-shield" id="icon_privacy"></i>
                <h1>Voulez-vous rendre vos informations publiques ?</h1>
            </div>
            <label class="register_switch">
                <input type="checkbox" name="showdata">
                <span class="register_slider round"></span>
            </label>
        </div>
    </div>
    <button type="submit" id="btn_confirm_login">S'inscrire</button>

</div>
</body>
</html>